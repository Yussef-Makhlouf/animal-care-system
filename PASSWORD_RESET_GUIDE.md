# ุฏููู ูุธุงู ุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ูุชูุงูู ูุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ ูุชุถูู:

- **ุงูุจุงู ุฅูุฏ**: API endpoints ุขููุฉ ูุงุณุชุนุงุฏุฉ ูููุฉ ุงููุฑูุฑ
- **ุงููุฑููุช ุฅูุฏ**: ูุงุฌูุงุช ูุณุชุฎุฏู ุณููุฉ ุงูุงุณุชุฎุฏุงู
- **ูุธุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**: ุฅุฑุณุงู ุฑูุงุจุท ุขููุฉ ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- **ุฃูุงู ูุชูุฏู**: ุฑููุฒ ูุคูุชุฉ ูุชุดููุฑ ุขูู

## ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### ๐ ุฃูุงู ูุชูุฏู
- ุฑููุฒ ุฅุนุงุฏุฉ ุงูุชุนููู ุตุงูุญุฉ ููุฏุฉ 15 ุฏูููุฉ ููุท
- ุชุดููุฑ ุขูู ููุฑููุฒ ุจุงุณุชุฎุฏุงู SHA-256
- ุญูุงูุฉ ูู ูุฌูุงุช ุงูููุฉ ุงูุบุงุดูุฉ

### ๐ง ูุธุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ููุงูุจ ุจุฑูุฏ ุฅููุชุฑููู ุงุญุชุฑุงููุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ
- ุฏุนู Gmail ู SMTP ูุฎุตุต
- ุฑุณุงุฆู HTML ู ูุตูุฉ

### ๐จ ูุงุฌูุฉ ูุณุชุฎุฏู ุญุฏูุซุฉ
- ุชุตููู ูุชุฌุงูุจ ูุฌููุน ุงูุฃุฌูุฒุฉ
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ

## ุงููููุงุช ุงููุถุงูุฉ/ุงููุญุฏุซุฉ

### ุงูุจุงู ุฅูุฏ

#### 1. API Endpoints (`ahcp-backend/src/routes/auth.js`)
```javascript
// ุทูุจ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ
POST /api/auth/forgot-password
{
  "email": "user@example.com"
}

// ุงูุชุญูู ูู ุตุญุฉ ุงูุฑูุฒ
POST /api/auth/verify-reset-token
{
  "token": "reset-token"
}

// ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ
POST /api/auth/reset-password
{
  "token": "reset-token",
  "password": "new-password"
}
```

#### 2. ุฎุฏูุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (`ahcp-backend/src/utils/emailService.js`)
- ุฅุนุฏุงุฏ nodemailer
- ููุงูุจ ุจุฑูุฏ ุฅููุชุฑููู ุงุญุชุฑุงููุฉ
- ุฏุนู HTML ู ูุต ุนุงุฏู

### ุงููุฑููุช ุฅูุฏ

#### 1. ุตูุญุฉ ูุณูุงู ูููุฉ ุงููุฑูุฑ (`ahcp-dashboard/app/forgot-password/page.tsx`)
- ูููุฐุฌ ุฅุฏุฎุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ุฑุณุงุฆู ูุฌุงุญ ูุฎุทุฃ ูุงุถุญุฉ
- ุฑุงุจุท ููุนูุฏุฉ ูุชุณุฌูู ุงูุฏุฎูู

#### 2. ุตูุญุฉ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ (`ahcp-dashboard/app/reset-password/[token]/page.tsx`)
- ุงูุชุญูู ุงูุชููุงุฆู ูู ุตุญุฉ ุงูุฑูุฒ
- ูููุฐุฌ ุฅุฏุฎุงู ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ
- ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ
- ุนุฑุถ ูุนูููุงุช ุงููุณุชุฎุฏู

#### 3. ุชุญุฏูุซ ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู (`ahcp-dashboard/app/login/page.tsx`)
- ุฅุถุงูุฉ ุฑุงุจุท "ูุณูุช ูููุฉ ุงููุฑูุฑุ"
- ุชุญุณูู ุงูุชุตููู

#### 4. ุชุญุฏูุซ API Functions (`ahcp-dashboard/lib/api/auth.ts`)
- `forgotPassword()` - ุทูุจ ุฅุนุงุฏุฉ ุชุนููู
- `resetPassword()` - ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ
- `verifyResetToken()` - ุงูุชุญูู ูู ุงูุฑูุฒ

## ุฅุนุฏุงุฏ ุงููุธุงู

### 1. ุฅุนุฏุงุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

#### ููุชุทููุฑ (Gmail)
```env
EMAIL_USER=your-email@gmail.com
EMAIL_PASS=your-16-character-app-password
EMAIL_FROM=noreply@ahcp.gov.sa
```

#### ููุฅูุชุงุฌ (SMTP ูุฎุตุต)
```env
SMTP_HOST=your-smtp-server.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@yourdomain.com
SMTP_PASS=your-email-password
```

### 2. ุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ

```env
# Frontend URL
FRONTEND_URL=http://localhost:3000

# Environment
NODE_ENV=development
```

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุณุชุฎุฏููู

1. **ูุณูุงู ูููุฉ ุงููุฑูุฑ**:
   - ุงุฐูุจ ุฅูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
   - ุงููุฑ ุนูู "ูุณูุช ูููุฉ ุงููุฑูุฑุ"
   - ุฃุฏุฎู ุจุฑูุฏู ุงูุฅููุชุฑููู
   - ุชุญูู ูู ุจุฑูุฏู ุงูุฅููุชุฑููู

2. **ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ**:
   - ุงููุฑ ุนูู ุงูุฑุงุจุท ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ
   - ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ
   - ุงููุฑ ุนูู "ุญูุธ ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ"

### ูููุทูุฑูู

#### ุงุฎุชุจุงุฑ ุงููุธุงู
```bash
# ุชุดุบูู ุงุฎุชุจุงุฑ ุดุงูู
node test-password-reset.js
```

#### API Testing
```bash
# ุทูุจ ุฅุนุงุฏุฉ ุชุนููู
curl -X POST http://localhost:3001/api/auth/forgot-password \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@ahcp.gov.sa"}'

# ุงูุชุญูู ูู ุงูุฑูุฒ
curl -X POST http://localhost:3001/api/auth/verify-reset-token \
  -H "Content-Type: application/json" \
  -d '{"token":"your-reset-token"}'

# ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ
curl -X POST http://localhost:3001/api/auth/reset-password \
  -H "Content-Type: application/json" \
  -d '{"token":"your-reset-token","password":"NewPassword123"}'
```

## ุงูุฃูุงู

### ุญูุงูุฉ ุงูุฑููุฒ
- ุฑููุฒ ุนุดูุงุฆูุฉ 32 ุจุงูุช
- ุชุดููุฑ SHA-256
- ุงูุชูุงุก ุตูุงุญูุฉ ุจุนุฏ 15 ุฏูููุฉ

### ุญูุงูุฉ ูู ุงููุฌูุงุช
- ุญูุงูุฉ ูู ูุฌูุงุช ุงูููุฉ ุงูุบุงุดูุฉ
- ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
- ุฑุณุงุฆู ุฎุทุฃ ุขููุฉ

### ุฃูุถู ุงูููุงุฑุณุงุช
- ูุง ุชุดุงุฑู ุฑููุฒ ุฅุนุงุฏุฉ ุงูุชุนููู
- ุงุณุชุฎุฏู ูููุงุช ูุฑูุฑ ูููุฉ
- ุชุญูู ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุจุงูุชุธุงู

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
1. **ุงูุจุฑูุฏ ูุง ูุตู**:
   - ุชุญูู ูู ูุฌูุฏ ุงูุฑุณุงุฆู ุงููุฒุนุฌุฉ
   - ุชุฃูุฏ ูู ุตุญุฉ ุฅุนุฏุงุฏุงุช SMTP
   - ุชุญูู ูู ุณุฌูุงุช ุงูุฎุงุฏู

2. **ุฎุทุฃ "Invalid login"**:
   - ุชุฃูุฏ ูู ุตุญุฉ ูููุฉ ูุฑูุฑ ุงูุชุทุจูู
   - ุชุฃูุฏ ูู ุชูุนูู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ

### ูุดุงูู ุงููุงุฌูุฉ
1. **ุงูุฑูุฒ ูุง ูุนูู**:
   - ุชุญูู ูู ุงูุชูุงุก ุตูุงุญูุฉ ุงูุฑูุฒ (15 ุฏูููุฉ)
   - ุชุฃูุฏ ูู ูุณุฎ ุงูุฑุงุจุท ูุงููุงู

2. **ุฎุทุฃ ูู ุงูุชุญูู**:
   - ุชุฃูุฏ ูู ุตุญุฉ ุงูุฑูุฒ
   - ุชุญูู ูู ุงุชุตุงู ุงูุฎุงุฏู

## ุงูุชุทููุฑ ุงููุณุชูุจูู

### ููุฒุงุช ููุชุฑุญุฉ
- [ ] ุฅุดุนุงุฑุงุช SMS
- [ ] ุณุฌู ุฃูุดุทุฉ ุฅุนุงุฏุฉ ุงูุชุนููู
- [ ] ุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช
- [ ] ุฏุนู ุงููุตุงุฏูุฉ ุงูุซูุงุฆูุฉ

### ุชุญุณููุงุช ุงูุฃูุงู
- [ ] ูุดู ูุญุงููุงุช ุงูุงุฎุชุฑุงู
- [ ] ุชูููุฏ ุนุฏุฏ ุงููุญุงููุงุช
- [ ] ุชุณุฌูู ุงูุฃุญุฏุงุซ ุงูุฃูููุฉ

## ุงูุฏุนู

ููุญุตูู ุนูู ุงูุฏุนู ุฃู ุงูุฅุจูุงุบ ุนู ูุดุงูู:
- ุชุญูู ูู ุณุฌูุงุช ุงูุฎุงุฏู
- ุฑุงุฌุน ููู `email-config.md`
- ุงุณุชุฎุฏู ููู ุงูุงุฎุชุจุงุฑ `test-password-reset.js`

---

**ููุงุญุธุฉ**: ุชุฃูุฏ ูู ุชุญุฏูุซ ูุชุบูุฑุงุช ุงูุจูุฆุฉ ูุจู ุงููุดุฑ ูู ุงูุฅูุชุงุฌ.
